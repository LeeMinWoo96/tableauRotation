<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URL Rotator</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f0f0f0;
        }
        #tableauViz {
            width: 100%;
            height: 100%;
        }
    </style>
    <script type="module" src="http://121.254.201.144/javascripts/api/tableau.embedding.3.6.0.min.js"></script>
    <script type="text/javascript" src="http://121.254.201.144/javascripts/api/viz_v1.js"></script> 

</head>
<body>
    <div id="tableauVizContainer">
        <tableau-viz id="tableauViz"       
            src=''      
            toolbar="bottom" hide-tabs>
        </tableau-viz>

        
    </div>
    <!-- aaaaaaaaaaaaaaaaa -->
    <!-- <object class="tableauViz" width="800" height="600"> 
        <param name="name" value="POS_NEW_2_17158490567760/POS&:iid=1" /> 
        <param name="ticket" value="HBH5PHd_Ro6Nu8DnBYWcjg==:yuBTw7fhQsyjsjffs4fTd1LV" /> 
    </object>  -->



    <script>
        const loadViz = (url) => {
            const vizContainer = document.getElementById('tableauVizContainer');
            const oldViz = document.getElementById('tableauViz');

            // Remove the old viz element
            if (oldViz) {
                oldViz.remove();
            }

            // Create a new viz element
            const newViz = document.createElement('tableau-viz');
            newViz.setAttribute('id', 'tableauViz');
            newViz.setAttribute('src', url);
            newViz.setAttribute('toolbar', 'bottom');
            newViz.setAttribute('hide-tabs', '');

            // Append the new viz element to the container
            vizContainer.appendChild(newViz);
        };

        const rotateUrl = () => {
            fetch('/api/rotate')
                .then(response => response.json())
                .then(data => {
                    loadViz(data.url);
                })
                .catch(error => {
                    console.error('Error fetching the URL:', error);
                });
        };

        setInterval(rotateUrl, 300000); // Change URL every 30 seconds
        rotateUrl(); // Initial load
    </script>
</body>
</html>
